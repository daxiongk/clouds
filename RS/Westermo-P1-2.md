# 第二章

## 2.1 第一次启动交换机

当交换机第一次启动时，交换机将使用出厂默认设置.

出厂默认设置使交换机作为一个**可管理**的二层交换机运行，其中所有以太网端口属于同一个VLAN.

- 可管理:交换机可通过任何以太网端口管理。要通过以太网端口管理交换机，您需要知道交换机的IP地址(参见表2.1)。对于配备了console端口的交换机，交换机也可以通过该端口进行管理，而不需要知道交换机的IP地址。

- 单个VLAN:默认情况下，交换机所有端口都属于同一个VLAN。因此，连接到交换机不同端口的设备应该能够立即相互通信。对于更高级的设置，交换机的端口可以分组到不同的vlan。在出厂默认设置下，所有端口都属于VLAN 1。

交换机的默认IP设置如表2.1所示:

|                       | Address       | Netmask       | Gateway   |
| --------------------- | ------------- | ------------- | --------- |
| 主IP地址(Primary)     | Dynamic(DHCP) | (Dynamic)     | (Dynamic) |
| 第二IP地址(Secondary) | 192.168.2.200 | 255.255.255.0 | Disabled  |

## 2.2 修改IP设置

交换机可以配置静态IP设置，也可以通过DHCP动态获取IP地址。如果您运行的DHCP服务器与交换机位于同一局域网,后一种情况是有用的。

WeOS提供了几种管理工具，将在本指南的后面章节进一步介绍。在本章中，我们描述如何使用这些工具来更新交换机的IP设置。

- WeConfig:是Westermo的网络配置管理工具(NCM)，用于调试和维护网络中的组件。它取代了以前被称为IPConfig的Westermo工具。有关WeConfig功能和如何使用工具的进一步信息，请参阅WeConfig用户指导.
- Web:通过Web界面配置IP设置将在本节中描述2.2.1
- CLI:通过命令行接口(CLI)配置IP设置在2.2.2节中描述。

### 2.2.1 通过Web界面更新交换机IP设置

要通过网络配置IP设置，您的交换机需要位于与您的PC相同的IP子网。

![image-20211011133939822](D:\Backup\clouds\clouds\img\image-20211011133939822.png)

在本例中，交换机将被分配IP地址192.168.55.100,netmask 255.255.255.0，默认网关192.168.55.1。要做到这一点，你必须(临时)修改PC的IP地址，以便能够与交换机通信。

通过web界面配置IP设置的步骤如下:

​	1.将PC机连接到交换机:如图所示，将PC机连接到交换机。

​	2.修改PC上的IP设置:PC上的IP设置必须更新以匹配交换机上的默认设置，即，PC应该被分配一个192.168.2.0/24网络的IP地址，例如:

- PC的IP地址:192.168.2.1
- PC的掩码:255.255.255.0

​	3.通过浏览器接入:打开浏览器，在浏览器地址栏输入URL http://192.168.2.200。您将被要求输入用户名和密码。使用出厂默认帐户设置，如下所示:	

![image-20211011135107206](D:\Backup\clouds\clouds\img\image-20211011135107206.png)

- 登陆用户名(login username):**admin**
- 密码(password):**westermo**

​    4.打开网络配置页面:单击“**Configuration**”顶部菜单，然后单击“**Network**”子菜单，然后单击“**Global Settings**”菜单。

​	5.配置默认网关:单击**Global Settings**框架中的编辑图标(✏)。下面的页面应该出现。

![image-20211011135123609](D:\Backup\clouds\clouds\img\image-20211011135123609.png)

在**Default Gateway**字段中填写适当的地址。在本例中，默认网关为192.168.55.1。单击**Apply**按钮。您的交换机配置了一个新的默认网关。

​	6.打开接口配置页面:单击**Configuration**顶部菜单，然后单击**Network**子菜单，然后单击**Interface**子菜单。在Interface页面,单击名为**vlan1**的接口所在行的编辑图标(✏)。界面配置页面将出现:

![image-20211011135546169](D:\Backup\clouds\clouds\img\image-20211011135546169.png)

​	7.配置接口IP设置:为您的交换机输入适当的IP设置。在这个例子中，我们会:

​	(a)设置“**IP Address Method**”为“**static**”(单选按钮);

​	(b)设置"**Primary Address**"为192.168.55.100,"**Netmask**"为255.255.255.0;

​	(c)使用垃圾图标(🚮)删除第二地址(192.168.2.200)。

​	单击Apply按钮，您的交换机就配置了一个新的IP地址.

8.重新配置PC的IP设置:由于交换机上的IP地址被更改，您的PC无法再访问它。访问交换机PC, PC的IP设置必须重新修改。在这种情况下，我们假设它被更改回原来的设置:

PC的IP地址:192.168.55.35

PC的掩码:255.255.255.0

PC的网关:192.168.55.1

### 2.2.2 通过CLI界面更新交换机IP设置

可以通过三种方式访问CLI:通过console口(假设交换机配置了console口)或通过使用Secure Shell的以太网端口(SSH)或Telnet协议。2.2.2.1介绍如何通过console口进入命令行，以及如何更新IP设置。通过SSH登录命令行，请参见2.2.2.2。

使用Telnet访问也是可能的，但在交换机上默认情况下没有启用它，要使用它，首先必须使用其他方法访问它，并启用该协议进行管理。关于如何在单元上启用Telnet服务，请参见8.3.34(命令行)章节，然后关于如何通过接口启用Telnet配置，请参见22.4 (Web)章节或22.6.6章节“vlan1”。

#### 2.2.2.1 通过console口进入CLI界面

对于配备了console口的WeOS交换机，可以使用该端口进行更改交换机IP地址。

将PC机连接到交换机:将PC机连接到交换机，如下图所示。

![image-20211011141410752](D:\Backup\clouds\clouds\img\image-20211011141410752.png)

终端程序:通过console口与交换机通信，需要使用PC上的终端仿真程序，如超级终端。
询问系统管理员是否需要帮助来安装或配置终端仿真程序。

连接console口需要进行如下配置:

| Console 端口参数 | 设置          |
| ---------------- | ------------- |
| 数据速率         | 115200 bits/s |
| 数据位           | 8             |
| 停止位           | 1             |
| 奇偶校验         | 无            |
| 流控制           | 无            |

3.激活控制台:当交换机完成启动时，您将被要求按键盘上的Enter键来激活控制台。

4.登录:现在将要求您输入用户名，然后输入密码。交换机出厂设置时，请使用如下登录用户名和密码:

- Login username:admin

- password:westermo

下面是登录WeOS交换机时的打印输出示例。(密码不会“回显”到屏幕上。)

![image-20211011142112125](D:\Backup\clouds\clouds\img\image-20211011142112125.png)

5.显示IP地址:使用CLI命令show iface显示网络接口信息。

![image-20211011142418154](D:\Backup\clouds\clouds\img\image-20211011142418154.png)

6.修改IP地址和netmask:修改交换机的IP地址模式(“static”而不是“DHCP”)，设置静态地址和子网掩码，并跳过第二地址，使用CLI命令“configure”，“iface vlan1”，“inet static”，“address <IPV4ADDRESS/LEN>”，“no address secondary”和“end”如下所示。这个示例基于第1步的设置，并在交换机上配置一个地址(192.168.55.100/24),和PC相同的IP子网。

![image-20211011143146033](D:\Backup\clouds\clouds\img\image-20211011143146033.png)

7.设置默认网关IP地址:下图显示了相同的网络设置，但是在IP子网上附加了一个路由器。使用这种设置，您需要配置一个默认网关IP地址，以允许从本地网络外部管理交换机。这可以通过CLI命令来实现“configure”，“ip”，“route default”192.168.55.1 <IPADDRESS> "，和" end "如下图所示。

![image-20211011143342122](D:\Backup\clouds\clouds\img\image-20211011143342122.png)

8.保存配置:虽然已经激活了配置更改，但是运行中的配置必须保存到启动配置中。否则，交换机重新启动后，更改的内容将丢失。

![image-20211011143551186](D:\Backup\clouds\clouds\img\image-20211011143551186.png)

9.现在您已经完成了交换机的IP地址、子网掩码和默认网关的设置。使用Logout命令退出CLI。

#### 2.2.2.2 通过SSH登录命令行

通过SSH/CLI配置IP设置与通过console口配置IP设置非常相似。主要的区别是:

- PC机的IP地址必须(临时)更改，以便能够与交换机通信，即PC机应该在网络192.168.2.0/24上有一个地址，例如192.168.2.1/24。
- 交换机上的IP设置发生变化后，PC机很可能与交换机失去接触。因此，PC必须再次修改其IP地址，并再次登录交换机，以便将运行配置复制到启动配置。

通过SSH/CLI配置IP的步骤如下:

1. 将PC机连接到交换机:将PC机连接到交换机，如下图所示。在本例中，我们假设交换机将获得IP地址192.168.55.100，子网掩码255.255.255.0，默认网关192.168.55.1。

![image-20211011143958396](D:\Backup\clouds\clouds\img\image-20211011143958396.png)

  2.修改PC上的IP设置:PC上的IP设置必须更新以匹配交换机上的默认设置，即，PC应该被分配一个192.168.2.0/24网络的IP地址，例如:

- PC的IP地址:192.168.2.1

- PC的掩码:255.255.255.0

3.连接和登录:当通过SSH连接时，您将被要求输入用户名和密码。交换机出厂设置时，请使用如下登录用户名和密码:

连接的过程可能略有不同，这取决于您使用的是什么SSH客户机。下面的示例展示了使用
Unix OpenSSH4。(在Windows上可以使用Putty5。)

![image-20211011144352036](D:\Backup\clouds\clouds\img\image-20211011144352036.png)





后续配置相同,不再累述.  